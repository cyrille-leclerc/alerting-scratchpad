{
  "__reference_metric_document": "https://gist.github.com/cyrille-leclerc/236263fb1a7d5f394865df3684b57f73",
  "__comments__": "",
   "cloud": {
      "availability_zone": "us-central1-a",
      "instance": {
        "name": "gke-eden-3-prod-pool-2-395ef018-06xg",
        "id": "1320867566735406612"
      },
      "provider": "gcp",
      "machine": {
        "type": "n1-standard-16"
      },
      "project": {
        "id": "elastic-product"
      }
    },
   "@timestamp":"2021-02-03T08:26:16.011Z",
   "ecs":{
      "version":"1.6.0"
   },
   "host": {
      "hostname": "gke-eden-3-prod-pool-2-395ef018-06xg",
      "os": {
        "kernel": "4.19.112+",
        "codename": "Core",
        "name": "CentOS Linux",
        "family": "redhat",
        "version": "7 (Core)",
        "platform": "centos"
      },
      "containerized": true,
      "ip": [
        "10.128.0.115",
        "fe80::4001:aff:fe80:73",
        "..."
      ],
      "name": "gke-eden-3-prod-pool-2-395ef018-06xg",
      "mac": [
        "42:01:0a:80:00:73",
        "..."
      ],
      "architecture": "x86_64"
    },
    "metricset": {
      "period": 10000,
      "name": "load"
    },
   "rule":{
      "author":"cyrille.leclerc@elastic.co",
      "category":"infrastructure-host-threshold",
      "category_help":"A categorization value keyword used by the entity using the rule for detection of this event.",
      "description_help":"The description of the rule generating the event.",
      "id":"1a137c91-6c45-11eb-a67b-55ab1a571eb4",
      "name":"APM Transaction Threshold",
      "ruleset_help":"Name of the ruleset, policy, group, or parent category in which the rule used to generate this event is a member. Example: Standard_Protocol_Filters",
      "tags":[
         "kubernetesNodes"
      ],
      "definition":{
         "inventory.type":"Host",
         "inventory.type_help":"hosts, kubernetes-pods, docker-containers, ec2-instances, s3-buckets, rds-databases, sqs-queues",
         "metrics": ["system.load"],
         "metric_help":"load, cpu, memory, log-rate, nework-traffic-in, network-traffic-out, custom-metric",
         "threshold-comparison": [">"],
         "threshold-comparison_help": ">, >=, <, <=",
         "threshold":[2],
         "conditions": [],
         "alertIfNoData": true,
         "filter": "'fields.env': 'production' and 'fields.hostType': 'kubernetesNode'"
      }
   },
   "signal":{
      "status":"open",
      "status_help":"what does it means? probably 'firing', 'not firing'...",
      "value":[3.5],
      "value_help":"value of the violation of the rule",
      "reason": "Load is greater than a threshold of 2 (current value is 3.5)",
      "url":"https://kibana.example.com/app/apm/services/advertService/transactions/view?rangeFrom=...&rangeTo=...&transactionName=...&transactionType=request&latencyAggregationType=avg...",
      "alertInstanceId": "gke-eden-3-prod-pool-2-395ef018-06xg"
   }
}
